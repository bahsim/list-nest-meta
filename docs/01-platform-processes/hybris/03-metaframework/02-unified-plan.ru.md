# Унифицированный план: Мета-фреймворк для управления легаси-платформой

> **Тип:** План реализации  
> **Категория:** Мета-фреймворк / Модернизация легаси  
> **Статус:** Черновик (Дорожная карта к действию)  
> **Назначение:** Предоставить конкретный, реализуемый план по созданию мета-фреймворка для управления, рефакторинга и миграции сложных легаси-платформ

---

## 1. Обзор технического дизайна

- **Цель:** Построить мета-фреймворк, который инвентаризирует, отображает и визуализирует все подсистемы, модули, файлы и внутренние единицы (методы, бины и т.д.) в легаси-платформе, а также их зависимости и метаданные.
- **Ключевые компоненты:**
  - **Модуль инвентаризации:** Автоматические скрипты для обхода кода и конфигов, извлекающие структуру и метаданные.
  - **Маппер зависимостей:** Инструменты для парсинга и отображения связей (импорты, инъекции, конфиг-ссылки).
  - **Извлечение метаданных:** Сбор информации о владельцах, истории изменений, документации и аннотациях.
  - **Модель системного графа:** Единое графовое представление всех узлов и связей с прикреплёнными метаданными.
  - **Слой запросов и визуализации:** CLI и/или UI для исследования, запросов и визуализации системного графа.

---

## 2. Этапы реализации (дорожная карта)

### **Этап 1: База и инвентаризация**
- Определить модель данных и схему графа
- Создать начальные скрипты инвентаризации (модули, файлы, внутренние единицы)
- Сохранять результаты в простой базе данных или графовом формате (например, Neo4j, SQLite, JSON)

### **Этап 2: Извлечение зависимостей и метаданных**
- Расширить скрипты для парсинга зависимостей (импорты, Spring-конфиги, extensioninfo.xml)
- Извлекать и прикреплять метаданные (владельцы, история VCS, документация)
- Валидировать и дорабатывать модель графа

### **Этап 3: Запросы и визуализация**
- Разработать CLI-инструменты для запросов к графу (например, "От чего зависит X?", "Показать все бины в модуле Y")
- Создать базовый web UI или интегрировать с существующими инструментами визуализации (например, Graphviz, Neo4j Browser)

### **Этап 4: Оркестрация и поддержка рефакторинга**
- Добавить функции для анализа влияния, планирования рефакторинга и отслеживания миграции
- Интегрировать с CI/CD или процессами code review по мере необходимости

---

## 3. План скриптов инвентаризации и извлечения зависимостей

- **Язык:** Предпочтительно Python (богатая экосистема для парсинга, графов и обработки данных)
- **Скрипты инвентаризации:**
  - Рекурсивно сканировать директории на наличие модулей, файлов и распознаваемых типов конфигов
  - Для каждого файла извлекать:
    - Тип файла (Java, XML, Impex и др.)
    - Внутренние единицы (классы, методы, бины и др.)
    - Аннотации и doc-комментарии
- **Извлечение зависимостей:**
  - Парсить импорты Java, ссылки на бины Spring, зависимости из extensioninfo.xml
  - Отображать связи интерфейс-реализация, слушатели событий и конфиг-ссылки
- **Извлечение метаданных:**
  - Использовать VCS (например, git) для получения частоты изменений, авторства
  - Парсить теги владельцев, TODO и ссылки на документацию
- **Вывод:**
  - Сохранять в формате JSON, CSV или напрямую в графовую базу данных (например, Neo4j)

---

## 4. Предлагаемая модель данных для системного графа

- **Типы узлов:**
  - Подсистема
  - Модуль
  - Файл
  - Внутренняя единица (класс, метод, бин и др.)
- **Типы связей:**
  - Зависимость (модуль-модуль, файл-файл, единица-единица)
  - Содержит (иерархия: модуль → файл → единица)
  - Ссылка на конфиг (например, инъекция бина, ссылка на конфиг)
- **Метаданные узлов:**
  - Имя, тип, путь
  - Владелец, бизнес-домен
  - Частота изменений, дата последнего изменения
  - Ссылки на документацию, известные проблемы
- **Метаданные связей:**
  - Тип зависимости (импорт, инъекция, конфиг)
  - Направленность, сила (опционально)

---

## 5. Ближайшие шаги

1. **Финализировать модель данных:** Составить и согласовать схему узлов/связей и поля метаданных
2. **Прототип скрипта инвентаризации:** Написать Python-скрипт для сканирования модулей/файлов и вывода начального JSON
3. **Парсер зависимостей:** Расширить скрипт для извлечения импортов Java и зависимостей из конфигов
4. **Загрузка графа:** Загрузить инвентаризацию и зависимости в графовую БД или in-memory модель
5. **Базовый CLI для запросов:** Реализовать простые запросы (например, список всех модулей, показать зависимости файла)
6. **Ревью и итерация:** Проверить результаты, доработать скрипты и спланировать визуализацию

---

Этот унифицированный план предоставляет конкретную, реализуемую дорожную карту для инициативы по созданию мета-фреймворка. В будущих документах будут подробно описаны техническая реализация, примеры скриптов и интеграционные паттерны. 